# 政府资金项目总结

### 简介

针对政府出台的制造业融资提升计划，提供相应的管理系统，方便政府、银行和企业管理和查看存款贷款情况。

该系统涉及角色管理、数据动态计算，表格动态生成、excel数据批量导入、导出、站内信等业务场景。

后端所用技术栈：springboot、mybatis-plus、redis、websocket、rabbitmq、easyexcel、springsecurity等框架及中间件。

### 项目难点

1. 部门删除时，用户仍能展示出部门名称。（框架限制过大，需要重写接口）
2. 批量插入数据时，数据异常提示。
3. 大数据量excel解析问题（大数据量excel处理，使用阿里的easyexcel框架）
4. 大数据量批量导入数据库产生的问题
   - mybatis-plus批量插入是一条一条插入的sql语句，效率低
   - smpe框架自己实现的批量插入方法不适用于，集合对象属性值不一致（有的属性为null，有的不为null）的问题。
   - 一条sql语句有最大长度限制的问题
   - 异步插入数据库时的问题
   - 批量插入时中间一条数据有异常如何回滚的问题。
   - 数据量大时查询效率低的问题
5. 此次项目核心业务计算复杂，涉及多个季度数据相互运算（两个集合匹配的元素进行计算），分组运算。（深刻的体会到了算法的重要性）
6. 关于复杂excel的生成。
7. 第三方网站跳转登录

### 收获

1. 如何批量插入大量数据，（异步加多线程插入）
2. 百万级数据量excel使用何种框架解析 easyexcel
3. 发现smpe存在的bug，做了部分优化

   - token过期配置不生效
   - mybatis-plus 批量插入无法忽略为null的值 ` done` 插入后无法将自增id设回实体类中 `done`
   - mybatis-plus 自动注入基本属性太慢 `done`
   - buildPage方法有问题，自动拼接上order by createTime 某有考虑多表查询时的问题。
   - sh脚本有问题

4. 处理完银行计算的业务后，对stream流的应用和理解加深了一层。
5. 复杂excel列合并和行合并的处理。
6. 第三方网站跳转登录。
7. 使用docker-compose部署项目，+能够熟练应用docker-compose。

### 不足

1. 算法不行，这次银行的复杂计算方式虽然实现了，但花了很长时间，效率很低，还是自己的算法太弱了，。
2. 项目排期太过乐观，没有给自己留白，待办总是因为一些没有考虑到的事情延期。
3. 写接口的顺序没有安排好，总是把难一点的排在前面，导致前端没办法往下进行。
4. 设计数据库时考虑不全，后期改动较多，间接影响到了项目的进度
5. 关于大数据量的业务没有很好的方案，应对很吃力。（多线程，数据库分库分表）

